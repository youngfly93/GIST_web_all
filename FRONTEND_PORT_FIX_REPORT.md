# ğŸ”§ å‰ç«¯è“å±é—®é¢˜ä¿®å¤æŠ¥å‘Š

## ğŸ“… ä¿®å¤æ—¶é—´
**2025å¹´10æœˆ16æ—¥ 12:27**

---

## âŒ é—®é¢˜æè¿°

**ç—‡çŠ¶**ï¼šhttps://www.dbgist.com/ æ˜¾ç¤ºçº¯è‰²è“å±ï¼Œæ— å†…å®¹

**æ ¹æœ¬åŸå› **ï¼šå¤šä¸ª Vite å®ä¾‹åŒæ—¶è¿è¡Œå¯¼è‡´ç«¯å£å†²çª

### é—®é¢˜è¯¦æƒ…

1. **å¤šè¿›ç¨‹å†²çª**ï¼š
   - æœ‰ä¸¤ä¸ª Vite è¿›ç¨‹åŒæ—¶è¿è¡Œï¼ˆPID: 2357204 å’Œ 2357630ï¼‰
   - åˆ†åˆ«å ç”¨ç«¯å£ 5173 å’Œ 5174
   - å¯¼è‡´èµ„æºå†²çªå’Œä¸ç¨³å®š

2. **ç«¯å£ä¸åŒ¹é…**ï¼š
   - Vite é»˜è®¤å°è¯•è¿è¡Œåœ¨ 5173
   - å¦‚æœ 5173 è¢«å ç”¨ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ° 5174
   - Nginx é…ç½®éœ€è¦åŒ¹é…å®é™…è¿è¡Œç«¯å£

---

## âœ… è§£å†³æ–¹æ¡ˆ

### 1. æ¸…ç†æ—§è¿›ç¨‹
```bash
pm2 stop gist-frontend
pm2 delete gist-frontend
kill -9 2357204 2357630
```

### 2. é‡å¯å‰ç«¯æœåŠ¡
```bash
cd /home/ylab/GIST_web_all/frontend
pm2 start npm --name "gist-frontend" -- run dev
```

### 3. æ›´æ–° Nginx é…ç½®
```bash
# å°†ç«¯å£æ”¹ä¸ºå®é™…è¿è¡Œç«¯å£ï¼ˆ5173ï¼‰
sed -i 's/:5174/:5173/g' /etc/nginx/sites-available/dbgist
nginx -t
systemctl reload nginx
```

### 4. ä¿å­˜é…ç½®
```bash
pm2 save
```

---

## ğŸ¯ æœ€ç»ˆçŠ¶æ€

âœ… **å‰ç«¯æœåŠ¡**ï¼šè¿è¡Œåœ¨ç«¯å£ 5173  
âœ… **Nginx é…ç½®**ï¼šæ­£ç¡®ä»£ç†åˆ° 5173  
âœ… **ç½‘ç«™çŠ¶æ€**ï¼šHTTP/2 200 OK  
âœ… **PM2 é…ç½®**ï¼šå·²ä¿å­˜ï¼Œé‡å¯åè‡ªåŠ¨æ¢å¤  

---

## ğŸ› ï¸ é¢„é˜²æªæ–½

### å·²åˆ›å»ºè‡ªåŠ¨ä¿®å¤è„šæœ¬

**ä½ç½®**ï¼š`/home/ylab/GIST_web_all/fix_frontend_port.sh`

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
bash /home/ylab/GIST_web_all/fix_frontend_port.sh
```

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨æ£€æµ‹ç«¯å£çŠ¶æ€
- æ¸…ç†å†²çªè¿›ç¨‹
- é‡å¯å‰ç«¯æœåŠ¡
- è‡ªåŠ¨æ›´æ–° Nginx é…ç½®
- ä¸€é”®ä¿®å¤è“å±é—®é¢˜

---

## ğŸ“‹ ä¸ºä»€ä¹ˆä¼šåå¤å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Ÿ

### å¯èƒ½åŸå› 

1. **Vite é…ç½®å˜åŒ–**
   - `vite.config.ts` è¢«ä¿®æ”¹æ—¶ Vite ä¼šè‡ªåŠ¨é‡å¯
   - é‡å¯æ—¶å¯èƒ½åˆ›å»ºæ–°è¿›ç¨‹è€Œæ²¡æœ‰æ€æ­»æ—§è¿›ç¨‹

2. **ç«¯å£å ç”¨**
   - ç³»ç»Ÿé‡å¯æˆ–æœåŠ¡å¼‚å¸¸æ—¶ï¼Œå¯èƒ½é—ç•™å ç”¨ç«¯å£çš„è¿›ç¨‹
   - Vite æ£€æµ‹åˆ° 5173 è¢«å ç”¨ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ° 5174

3. **PM2 ç®¡ç†é—®é¢˜**
   - PM2 é‡å¯æ—¶å¯èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹
   - éœ€è¦å®šæœŸæ¸…ç†

### é¢„é˜²å»ºè®®

1. **å®šæœŸæ£€æŸ¥**ï¼š
   ```bash
   # æ£€æŸ¥æ˜¯å¦æœ‰å¤šä¸ª Vite è¿›ç¨‹
   ps aux | grep vite | grep -v grep
   
   # æ£€æŸ¥ç«¯å£å ç”¨
   netstat -tlnp | grep 517
   ```

2. **å‡ºç°é—®é¢˜æ—¶**ï¼š
   ```bash
   # è¿è¡Œè‡ªåŠ¨ä¿®å¤è„šæœ¬
   bash /home/ylab/GIST_web_all/fix_frontend_port.sh
   ```

3. **æ‰‹åŠ¨ä¿®å¤**ï¼š
   ```bash
   # åœæ­¢æ‰€æœ‰å‰ç«¯æœåŠ¡
   pm2 stop gist-frontend
   pkill -9 -f vite
   
   # é‡å¯
   pm2 start gist-frontend
   
   # æ£€æŸ¥ç«¯å£å¹¶æ›´æ–° Nginx
   netstat -tlnp | grep 517
   ```

---

## ğŸ” æ•…éšœæ’æŸ¥æ¸…å•

å¦‚æœå†æ¬¡å‡ºç°è“å±ï¼ŒæŒ‰é¡ºåºæ£€æŸ¥ï¼š

1. âœ… **å‰ç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ**
   ```bash
   pm2 list | grep frontend
   ```

2. âœ… **ç«¯å£æ˜¯å¦æ­£ç¡®**
   ```bash
   netstat -tlnp | grep 517
   ```

3. âœ… **Nginx é…ç½®æ˜¯å¦åŒ¹é…**
   ```bash
   grep "proxy_pass.*517" /etc/nginx/sites-available/dbgist
   ```

4. âœ… **æ˜¯å¦æœ‰å¤šä¸ªè¿›ç¨‹**
   ```bash
   ps aux | grep vite | grep -v grep | wc -l
   # åº”è¯¥åªæœ‰ 1 ä¸ª
   ```

5. âœ… **æµè§ˆå™¨ç¼“å­˜**
   - æ¸…é™¤ç¼“å­˜ï¼ˆCtrl+Shift+Deleteï¼‰
   - å¼ºåˆ¶åˆ·æ–°ï¼ˆCtrl+F5ï¼‰

---

## ğŸ“ å¿«é€Ÿä¿®å¤å‘½ä»¤

å¦‚æœå†æ¬¡å‡ºç°é—®é¢˜ï¼Œç›´æ¥è¿è¡Œï¼š

```bash
# æ–¹æ³• 1ï¼šä½¿ç”¨è‡ªåŠ¨ä¿®å¤è„šæœ¬
bash /home/ylab/GIST_web_all/fix_frontend_port.sh

# æ–¹æ³• 2ï¼šæ‰‹åŠ¨ä¸€é”®ä¿®å¤
pm2 stop gist-frontend; pm2 delete gist-frontend; pkill -9 -f vite; sleep 2; cd /home/ylab/GIST_web_all/frontend && pm2 start npm --name "gist-frontend" -- run dev; sleep 3; ACTUAL_PORT=$(netstat -tlnp | grep node | grep -oP '517\d'); sed -i "s/:517[0-9]/:$ACTUAL_PORT/g" /etc/nginx/sites-available/dbgist; nginx -t && systemctl reload nginx; pm2 save
```

---

## âœ¨ æ€»ç»“

**é—®é¢˜**ï¼šå¤š Vite è¿›ç¨‹å†²çª  
**è§£å†³**ï¼šæ¸…ç† + é‡å¯ + é…ç½®åŒæ­¥  
**é¢„é˜²**ï¼šè‡ªåŠ¨ä¿®å¤è„šæœ¬ + å®šæœŸæ£€æŸ¥  

---

**ä¿®å¤å®Œæˆæ—¶é—´**ï¼š2025-10-16 12:27  
**çŠ¶æ€**ï¼šâœ… å·²å®Œå…¨ä¿®å¤  
**éªŒè¯**ï¼šhttps://www.dbgist.com/ æ­£å¸¸è®¿é—®

